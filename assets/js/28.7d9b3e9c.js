(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{557:function(t,a,e){"use strict";e.r(a);var s=e(6),l=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[t._v("今天作死，把线上运行中的表优化了一下，结果把表锁住了。")])]),t._v(" "),e("blockquote",[e("p",[t._v("下面记录一下解决死锁的两种方法")])]),t._v(" "),e("blockquote",[e("p",[t._v("第一种：")])]),t._v(" "),e("ul",[e("li",[t._v("查询是否锁表")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("    SHOW OPEN TABLES WHERE In_use > 0;    \n")])])]),e("ul",[e("li",[t._v("查询进程（如果您有SUPER权限，您可以看到所有线程。否则，您只能看到自己的）")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("    SHOW processlist\n")])])]),e("ul",[e("li",[t._v("杀死进程ID（就是上面命令的id列）")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("    kill {id}\n")])])]),e("blockquote",[e("p",[t._v("第二种")])]),t._v(" "),e("ul",[e("li",[t._v("查看在锁的事务")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("    SELECT * FROM INFORMATION_SCHEMA.INNODB_TRX;\n")])])]),e("ul",[e("li",[t._v("杀死进程id（上面命令返回的trx_mysql_thread_id）")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("    kill {id}\n")])])]),e("blockquote",[e("p",[t._v("其它关于查看死锁的命令")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("-- 查看当前的事务\nSELECT * FROM INFORMATION_SCHEMA.INNODB_TRX;\n\n-- 查看当前锁定的事务\nSELECT * FROM INFORMATION_SCHEMA.INNODB_LOCKS;\n\n-- 查看当前等锁的事务\nSELECT * FROM INFORMATION_SCHEMA.INNODB_LOCK_WAITS; \n")])])])])}),[],!1,null,null,null);a.default=l.exports}}]);